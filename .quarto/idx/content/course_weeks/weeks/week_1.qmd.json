{"title":"1 - Introduction to Causal Inference","markdown":{"yaml":{"title":"1 - Introduction to Causal Inference","linktitle":"1 - Introduction to Causal Inference","output":{"blogdown::html_page":{"toc":true}},"menu":{"example":{"parent":"Course content","weight":1}},"type":"docs","editor_options":{"chunk_output_type":"console"},"editor":{"markdown":{"wrap":72}}},"headingText":"custom ggplot theme","containsRefs":false,"markdown":"\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(fig.width = 6, fig.asp = 0.618, fig.align = \"center\", fig.retina = 3, out.width = \"75%\")\nset.seed(11)\noptions(\"digits\" = 2, \"width\" = 150)\noptions(dplyr.summarise.inform = FALSE)\n\n# colors from TUHH brand identitiy\ntuhh_colors <- c(\"#D0D0CE\", \"#00C1D4\", \"#FF4F4F\", \"#5AFFC5\",\n                 \"#FFDE36\", \"#143BFF\", \"#FF7E15\", \"#FFAEA2\")\n\n# initialise theme\ncds_theme <- ggthemr::define_palette(\n  swatch = tuhh_colors,\n  gradient = c(lower = \"#FFAEA2\", upper = \"#00C1D4\"),\n  background = \"#0F2231\",\n  line = c(\"#FFFFFF\", \"#FFFFFF\"),\n  text = c(\"#FFFFFF\", \"#FFFFFF\"),\n  gridline = c(ggplot2::alpha(\"#D0D0CE\", 0.2), \n               ggplot2::alpha(\"#D0D0CE\", 0.4))\n)\n\n# set theme\nggthemr::ggthemr(cds_theme, type = \"outer\")\n\n# source custom DAG theme\nsource(paste0(here::here(), \"/code/dag_theme.R\"))\n```\n\n::: callout-important\nPlease make sure to read and follow the instructions in **[Organization](../../organization/mattermost.qmd)** before reading this section.\n:::\n\n## Slides & Recap\n\n**[Slides - Week 1](../../../lecture/01.pdf)**\n\n## Practical example\n\n### Simpson paradox\n\nLet's go through a practical example of the Yule-Simpson paradox in a business context.\nImagine the following situation: you have developed a new product that you want to advertise online.\nneeded everywhere e.g. phone\n\nAfter running your ad campaign you are interested in the effectiveness of your ads by age group.\nFor simplicity, we divide the age groups into young and old. \nYou run the numbers and get the following results for whether a website visitor who was shown the ad clicks.\n\n\n| OVERALL | Click | No click |\n|---------|-------|----------|\n| Young   | 500   | 10'000   |\n| Old     | 300   | 7'500    |\n\nFrom here, we can compute the click-through rate (CTR):\n\n```{r}\n# Overall\nctr_yng <- 500 / (500 + 10000) # young\nctr_old <- 300 / (300 + 7500) # old\n\n# Difference\nctr_yng - ctr_old\n```\n\nYou draw the conclusion that ads on young people were more effective.\n\nHowever, you sense that this might be a case of the Simpson paradox and identify region as a potential confounder.\nDividing your data by region, for simplicity only urban and rural, you get the numbers ...\n\nfor your advertising performance in *urban regions*\n\n\n| URBAN | Click | No click |\n|-------|-------|----------|\n| Young | 350   | 4'000    |\n| Old   | 80    | 500      |\n\nand in *rural regions*.\n\n| RURAL | Click | No click |\n|-------|-------|----------|\n| Young | 150   | 6'000    |\n| Old   | 220   | 7'000    |\n\nAs before, you compute the CTRs, but now by region. First for urban areas:\n\n```{r}\n# Urban region\nctr_yng_urb <- 350 / (350 + 4000) # young people\nctr_old_urb <- 80 / (80 + 500) # old people\n\n# Difference\nctr_yng_urb - ctr_old_urb\n```\n\nOther than for the overall effect, the effect of ads for old people is higher causing the difference to be negative. Now, intuitively, you would think that for rural areas, the effect for ads on young people would be substantially higher than for old people to explain the overall higher effect for young people. Let'check:\n\n```{r}\n# Rural region\nctr_yng_rur <- 150 / (150 + 6000) # young\nctr_old_rur <- 220 / (220 + 7000) # old\n\n# Difference\nctr_yng_rur - ctr_old_rur\n```\n\nAnd, surprisingly, you see the difference is again negative, indicating more reaction among old people.\n\n::: callout-note\nTo neatly format variables in a desired manner, use `sprintf()``. Simply furnish a string template with placeholders for variables or expressions. These can encompass strings, integers, floats, and more.\n:::\n\n```{r}\nsprintf(\"All areas: %.2f %%\", 100 * (ctr_yng - ctr_old))\nsprintf(\"Urban area: %.2f %%\", 100 * (ctr_yng_urb - ctr_old_urb))\nsprintf(\"Rural area: %.2f %%\", 100 * (ctr_yng_rur - ctr_old_rur))\n```\n\nBecause the combination of two negative differences resulting in a positive difference is unexpected at first, this scenario is labelled a **paradox**. In the assignment, you will be asked to explain why it happens.\n\n<!--\n\"When less effective treatment applied more frequently to less severe cases, it \nappears to be more effective.\"\nTranslated to our scenario: \n  - 'less effective treatment': young people because they are less reactive to \n  ads.\n  - ' less severe cases': people in urban areas because they have a higher CTR.\nBecause there are more young people in urban areas, treating young people \nappears to be more effective in the overall analysis. However, when analyzed\nby region, it shows that in fact, older people are more likely to react to an \nad.\n-->\n\n\n```{r}\n#| include: false\n\n# clicks\nyu1 <- 350\nyr1 <- 150\nou1 <- 80\nor1 <- 220\n\n# no clicks\nyu0 <- 4000\nyr0 <- 6000\nou0 <- 500\nor0 <- 7000\n\n# individal CTRs\n# urban region\nyu1 / (yu1 + yu0)\nou1 / (ou1 + ou0)\n# rural region\nyr1 / (yr1 + yr0)\nor1 / (or1 + or0)\n\n# combined CTRs\n(yu1 + yr1) / (yu1 + yu0 + yr1 + yr0)\n(ou1 + or1) / (ou1 + ou0 + or1 + or0)\n\n#\n(yu1 + yr1)\n(yu0 + yr0)\n(ou1 + or1)\n(ou0 + or0)\n\n```\n\n## Assignment\n\n::: assignment\nPlease go to [Week 1 -\nAssignment](https://classroom.github.com/a/qKNVakO4) and solve the\nfollowing questions. For the first week, there is only one actual\nquestion and we do not grade your solutions as the primary objective is\nto ensure you understand the workflow and submission process via GitHub,\nas well as to familiarize yourself with R.\n\n1.  What is 1+1 ?\n\n2.  What is 2+2 ?\n\n3.  Take a closer look at the numbers (outcome, sample sizes etc.) of\n    the practical example of a Simpson paradox. Give an explanation why\n    the Simpson paradox occurs (1-2 sentences).\n:::\n","srcMarkdownNoYaml":"\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(fig.width = 6, fig.asp = 0.618, fig.align = \"center\", fig.retina = 3, out.width = \"75%\")\nset.seed(11)\noptions(\"digits\" = 2, \"width\" = 150)\noptions(dplyr.summarise.inform = FALSE)\n\n# custom ggplot theme\n# colors from TUHH brand identitiy\ntuhh_colors <- c(\"#D0D0CE\", \"#00C1D4\", \"#FF4F4F\", \"#5AFFC5\",\n                 \"#FFDE36\", \"#143BFF\", \"#FF7E15\", \"#FFAEA2\")\n\n# initialise theme\ncds_theme <- ggthemr::define_palette(\n  swatch = tuhh_colors,\n  gradient = c(lower = \"#FFAEA2\", upper = \"#00C1D4\"),\n  background = \"#0F2231\",\n  line = c(\"#FFFFFF\", \"#FFFFFF\"),\n  text = c(\"#FFFFFF\", \"#FFFFFF\"),\n  gridline = c(ggplot2::alpha(\"#D0D0CE\", 0.2), \n               ggplot2::alpha(\"#D0D0CE\", 0.4))\n)\n\n# set theme\nggthemr::ggthemr(cds_theme, type = \"outer\")\n\n# source custom DAG theme\nsource(paste0(here::here(), \"/code/dag_theme.R\"))\n```\n\n::: callout-important\nPlease make sure to read and follow the instructions in **[Organization](../../organization/mattermost.qmd)** before reading this section.\n:::\n\n## Slides & Recap\n\n**[Slides - Week 1](../../../lecture/01.pdf)**\n\n## Practical example\n\n### Simpson paradox\n\nLet's go through a practical example of the Yule-Simpson paradox in a business context.\nImagine the following situation: you have developed a new product that you want to advertise online.\nneeded everywhere e.g. phone\n\nAfter running your ad campaign you are interested in the effectiveness of your ads by age group.\nFor simplicity, we divide the age groups into young and old. \nYou run the numbers and get the following results for whether a website visitor who was shown the ad clicks.\n\n\n| OVERALL | Click | No click |\n|---------|-------|----------|\n| Young   | 500   | 10'000   |\n| Old     | 300   | 7'500    |\n\nFrom here, we can compute the click-through rate (CTR):\n\n```{r}\n# Overall\nctr_yng <- 500 / (500 + 10000) # young\nctr_old <- 300 / (300 + 7500) # old\n\n# Difference\nctr_yng - ctr_old\n```\n\nYou draw the conclusion that ads on young people were more effective.\n\nHowever, you sense that this might be a case of the Simpson paradox and identify region as a potential confounder.\nDividing your data by region, for simplicity only urban and rural, you get the numbers ...\n\nfor your advertising performance in *urban regions*\n\n\n| URBAN | Click | No click |\n|-------|-------|----------|\n| Young | 350   | 4'000    |\n| Old   | 80    | 500      |\n\nand in *rural regions*.\n\n| RURAL | Click | No click |\n|-------|-------|----------|\n| Young | 150   | 6'000    |\n| Old   | 220   | 7'000    |\n\nAs before, you compute the CTRs, but now by region. First for urban areas:\n\n```{r}\n# Urban region\nctr_yng_urb <- 350 / (350 + 4000) # young people\nctr_old_urb <- 80 / (80 + 500) # old people\n\n# Difference\nctr_yng_urb - ctr_old_urb\n```\n\nOther than for the overall effect, the effect of ads for old people is higher causing the difference to be negative. Now, intuitively, you would think that for rural areas, the effect for ads on young people would be substantially higher than for old people to explain the overall higher effect for young people. Let'check:\n\n```{r}\n# Rural region\nctr_yng_rur <- 150 / (150 + 6000) # young\nctr_old_rur <- 220 / (220 + 7000) # old\n\n# Difference\nctr_yng_rur - ctr_old_rur\n```\n\nAnd, surprisingly, you see the difference is again negative, indicating more reaction among old people.\n\n::: callout-note\nTo neatly format variables in a desired manner, use `sprintf()``. Simply furnish a string template with placeholders for variables or expressions. These can encompass strings, integers, floats, and more.\n:::\n\n```{r}\nsprintf(\"All areas: %.2f %%\", 100 * (ctr_yng - ctr_old))\nsprintf(\"Urban area: %.2f %%\", 100 * (ctr_yng_urb - ctr_old_urb))\nsprintf(\"Rural area: %.2f %%\", 100 * (ctr_yng_rur - ctr_old_rur))\n```\n\nBecause the combination of two negative differences resulting in a positive difference is unexpected at first, this scenario is labelled a **paradox**. In the assignment, you will be asked to explain why it happens.\n\n<!--\n\"When less effective treatment applied more frequently to less severe cases, it \nappears to be more effective.\"\nTranslated to our scenario: \n  - 'less effective treatment': young people because they are less reactive to \n  ads.\n  - ' less severe cases': people in urban areas because they have a higher CTR.\nBecause there are more young people in urban areas, treating young people \nappears to be more effective in the overall analysis. However, when analyzed\nby region, it shows that in fact, older people are more likely to react to an \nad.\n-->\n\n\n```{r}\n#| include: false\n\n# clicks\nyu1 <- 350\nyr1 <- 150\nou1 <- 80\nor1 <- 220\n\n# no clicks\nyu0 <- 4000\nyr0 <- 6000\nou0 <- 500\nor0 <- 7000\n\n# individal CTRs\n# urban region\nyu1 / (yu1 + yu0)\nou1 / (ou1 + ou0)\n# rural region\nyr1 / (yr1 + yr0)\nor1 / (or1 + or0)\n\n# combined CTRs\n(yu1 + yr1) / (yu1 + yu0 + yr1 + yr0)\n(ou1 + or1) / (ou1 + ou0 + or1 + or0)\n\n#\n(yu1 + yr1)\n(yu0 + yr0)\n(ou1 + or1)\n(ou0 + or0)\n\n```\n\n## Assignment\n\n::: assignment\nPlease go to [Week 1 -\nAssignment](https://classroom.github.com/a/qKNVakO4) and solve the\nfollowing questions. For the first week, there is only one actual\nquestion and we do not grade your solutions as the primary objective is\nto ensure you understand the workflow and submission process via GitHub,\nas well as to familiarize yourself with R.\n\n1.  What is 1+1 ?\n\n2.  What is 2+2 ?\n\n3.  Take a closer look at the numbers (outcome, sample sizes etc.) of\n    the practical example of a Simpson paradox. Give an explanation why\n    the Simpson paradox occurs (1-2 sentences).\n:::\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"paged","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":{"blogdown::html_page":{"toc":true}},"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":true,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","filters":["lightbox"],"css":["../../../styles.css"],"toc":true,"output-file":"week_1.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.4.536","lightbox":{"match":"auto"},"editor":{"markdown":{"wrap":72}},"theme":["darkly","../../../theme-darkly.scss"],"mainfont":"arial","linestretch":1.7,"title":"1 - Introduction to Causal Inference","linktitle":"1 - Introduction to Causal Inference","menu":{"example":{"parent":"Course content","weight":1}},"type":"docs","editor_options":{"chunk_output_type":"console"}},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}