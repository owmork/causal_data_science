rand_encdf
df
df |> filter(rand_enc==0, used_ftr==1)
df$time_spent[df$rand_enc == 1, ]
df[df$rand_enc == 1, ]$time_spent
num <- df[df$rand_enc == 1, ]$time_spent - df[df$rand_enc == 0, ]$time_spent
den <- df[df$rand_enc == 1, ]$used_ftr - df[df$rand_enc == 0, ]$used_ftr
den <- mean(df[df$rand_enc == 1, ]$used_ftr) - mean(df[df$rand_enc == 0, ]$used_ftr)
num <- mean(df[df$rand_enc == 1, ]$time_spent) - mean(df[df$rand_enc == 0, ]$time_spent)
den <- mean(df[df$rand_enc == 1, ]$used_ftr) - mean(df[df$rand_enc == 0, ]$used_ftr)
num/den
model_iv <- iv_robust(time_spent ~ used_ftr | rand_enc, data = df)
broom::tidy(model_iv)
# [1] Estimation ----
library(estimatr)
model_iv <- iv_robust(time_spent ~ used_ftr | rand_enc, data = df)
broom::tidy(model_iv)
# (a)
lm(used_ftr ~ rand_enc, data = df)
# (a)
stage_1 <- lm(used_ftr ~ rand_enc, data = df)
stage_1$fitted.values
df$used_ftr_hat <- stage_1$fitted.values
stage_2 <- lm(time_spent ~ used_ftr_hat, data = df)
stage_2
summary(stage_2)
ivreg(time_spent ~ rand_enc | used_ftr, data = df)
# Load package
library(AER)
ivreg(time_spent ~ rand_enc | used_ftr, data = df)
tsls <- ivreg(time_spent ~ rand_enc | used_ftr, data = df)
summary(tsls)
summary(tsls, vcov = vcovHC)
iv_robust(time_spent ~ used_ftr | rand_enc, data = df)
?ivreg
rand_enc
rm(rand_enc)
tsls <- ivreg(time_spent ~ rand_enc | used_ftr, data = df)
summary(tsls, vcov = vcovHC)
time_spent
used_ftr
rm(time_spent)
rm(used_ftr)
ivreg(time_spent ~ rand_enc | used_ftr, data = df)
tsls <- ivreg(time_spent ~ used_ftr | rand_enc, data = df)
summary(tsls, vcov = vcovHC)
summary(stage_2)
library(tidyverse)
set.seed(11)
# Randomized Encouragement Trial
# Causal Effect: new feature on time spent in app
# You don't want to run an A/B test and offer it to all customers directly.
# Only comparing users of feature to non-users results in biased estimate as
# some users might be more benefiting from it.
# Therefore, a random selection of users is encouraged to use new feature with
# a popup message in app.
# Instrument: randomized encouragement
# Treatment: new feature
# Outcome: time spent in app
# Confounder: need for feature
# [0] Data ----
n <- 1e+4
# simulate who was encouraged to use feature
popup <- rbinom(n, size = 1, prob = .5)
# simulate age. younger users more likely to adapt.
age <- rbeta(n, 2, 5) %>% scales::rescale(to = c(12, 65))
# simulate who used feature
use_enc  <- .35 + (8/age) # (encouraged group)
use_enc[use_enc>1] <- 1
use_nenc <- .0 + (8/age)# (not encouraged group)
used_ftr <- rbinom(n, size = 1, if_else(popup == 1, use_enc, use_nenc))
# simulate outcome. users who use feature spend more time on app.
time_spent <- 10*used_ftr + .8*(100-age) + rnorm(n, 5, 5)
df <- tibble(popup   = popup,
used_ftr   = used_ftr,
unobserved = age,
time_spent = time_spent)
cor(df) %>% round(2)
saveRDS(df %>% select(-unobserved), "content/course_weeks/week_07/rand_enc.rds")
readRDS("https://cloud.tuhh.de/remote.php/dav/files/com6019/CDS_SS24/rand_enc.rds")
readRDS(refhook = "https://cloud.tuhh.de/remote.php/dav/files/com6019/CDS_SS24/rand_enc.rds")
readRDS(url(https://cloud.tuhh.de/remote.php/dav/files/com6019/CDS_SS24/rand_enc.rds))
readRDS(url("https://cloud.tuhh.de/remote.php/dav/files/com6019/CDS_SS24/rand_enc.rds"))
rand_enc <- readRDS("~/my_drive/02_TUHH/03_github/causal_ds_ss24/content/course_weeks/week_07/rand_enc.rds")
cov(rand_enc$time_spent, rand_enc$popup) / cov(rand_enc$used_ftr, rand_enc$popup)
num <- mean(rand_enc$time_spent[rand_enc$popup == 1, ]) - mean(rand_enc$time_spent[rand_enc$popup == 0, ])
den <- mean(rand_enc$used_ftr[rand_enc$popup == 1, ]) - mean(rand_enc$used_ftr[rand_enc$popup == 0, ])
num <- mean(rand_enc[rand_enc$popup == 1, ]$time_spent) - mean(rand_enc[rand_enc$popup == 0, ]$time_spent)
den <- mean(rand_enc[rand_enc$popup == 1, ]$used_ftr) - mean(rand_enc[rand_enc$popup == 0, ]$used_ftr)
num/den
rand_enc <- readRDS("~/my_drive/02_TUHH/03_github/causal_ds_ss24/content/course_weeks/week_07/rand_enc.rds")
rand_enc
rand_enc
install.packages("sensemakr")
#install.packages("sensemakr")
library(sensemakr)
data(pension) # Get data
# runs conditional outcome regression model
model <- lm(net_tfa ~ p401 + age + db + educ + fsize + hown + inc +
male + marr + pira + twoearn, data = pension)
hdm::pension
pension <- hdm::pension # Get data
# runs conditional outcome regression model
model <- lm(net_tfa ~ p401 + age + db + educ + fsize + hown + inc +
male + marr + pira + twoearn, data = pension)
# runs sensemakr for sensitivity analysis
sensitivity <- sensemakr(model = model, treatment = "p401",
benchmark_covariates = c("inc"), kd=1:3)
sensitivity
plot(sensitivity)
library(tidyverse)
set.seed(11)
# [0] Data ----
n <- 1e+4
# simulate who was encouraged to use feature
popup <- rbinom(n, size = 1, prob = .5)
# simulate age. younger users more likely to adapt.
age <- rbeta(n, 2, 5) %>% scales::rescale(to = c(12, 65))
# simulate who used feature
use_enc  <- .35 + (8/age) # (encouraged group)
use_enc[use_enc>1] <- 1
use_nenc <- .0 + (8/age)# (not encouraged group)
used_ftr <- rbinom(n, size = 1, if_else(popup == 1, use_enc, use_nenc))
# simulate outcome. users who use feature spend more time on app.
time_spent <- 10*used_ftr + .8*(100-age) + rnorm(n, 5, 5)
saveRDS(df, "content/course_weeks/week_07/rand_enc_assignment.rds")
rand_enc2 <- readRDS("~/my_drive/02_TUHH/03_github/causal_ds_ss24/content/course_weeks/week_07/rand_enc_assignment.rds")
rand_enc2
rand_enc_assignment <- readRDS("~/my_drive/02_TUHH/03_github/causal_ds_ss24/content/course_weeks/week_07/rand_enc_assignment.rds")
rand_enc_assignment()
df
df <- tibble(popup   = popup,
used_ftr   = used_ftr,
unobserved = age,
time_spent = time_spent)
saveRDS(df, "content/course_weeks/week_07/rand_enc_assignment.rds")
re2 <- readRDS("~/my_drive/02_TUHH/03_github/causal_ds_ss24/content/course_weeks/week_07/rand_enc_assignment.rds")
re2
# runs conditional outcome regression model
model <- lm(time_spent ~ used_ftr + unobserved, data = re2)
# runs sensemakr for sensitivity analysis
sensitivity <- sensemakr(model = model, treatment = "used_ftr",
benchmark_covariates = c("unobserved"), kd=1:3)
# runs sensemakr for sensitivity analysis
sensitivity <- sensemakr(model = model, treatment = "used_ftr",
benchmark_covariates = c("unobserved"), kd=1:2)
# runs sensemakr for sensitivity analysis
sensitivity <- sensemakr(model = model, treatment = "used_ftr",
benchmark_covariates = c("unobserved"), kd=1)
# runs sensemakr for sensitivity analysis
sensitivity <- sensemakr(model = model, treatment = "used_ftr",
benchmark_covariates = c("unobserved"), kd=.5)
sensitivity
plot(sensitivity)
summary(sensitivity)
summary(model)
summmary(lm(time_spent ~  unobserved, data = re2))
summary(lm(time_spent ~  unobserved, data = re2))
# simulate who was encouraged to use feature
popup <- rbinom(n, size = 1, prob = .5)
# simulate age. younger users more likely to adapt.
age <- rbeta(n, 2, 5) %>% scales::rescale(to = c(12, 65))
# simulate who used feature
use_enc  <- .35 + (2/age) # (encouraged group)
use_enc[use_enc>1] <- 1
use_nenc <- .0 + (2/age)# (not encouraged group)
used_ftr <- rbinom(n, size = 1, if_else(popup == 1, use_enc, use_nenc))
# simulate outcome. users who use feature spend more time on app.
time_spent <- 10*used_ftr + .3*(100-age) + rnorm(n, 5, 5)
df <- tibble(popup   = popup,
used_ftr   = used_ftr,
unobserved = age,
time_spent = time_spent)
cor(df) %>% round(2)
saveRDS(df, "content/course_weeks/week_07/rand_enc_assignment.rds")
# simulate who was encouraged to use feature
popup <- rbinom(n, size = 1, prob = .5)
# simulate age. younger users more likely to adapt.
age <- rbeta(n, 2, 5) %>% scales::rescale(to = c(12, 65))
# simulate who used feature
use_enc  <- .35 + (4/age) # (encouraged group)
use_enc[use_enc>1] <- 1
use_nenc <- .0 + (4/age)# (not encouraged group)
used_ftr <- rbinom(n, size = 1, if_else(popup == 1, use_enc, use_nenc))
# simulate outcome. users who use feature spend more time on app.
time_spent <- 10*used_ftr + .05*(100-age) + rnorm(n, 5, 5)
df <- tibble(popup   = popup,
used_ftr   = used_ftr,
unobserved = age,
time_spent = time_spent)
cor(df) %>% round(2)
saveRDS(df, "content/course_weeks/week_07/rand_enc_assignment.rds")
# simulate who was encouraged to use feature
popup <- rbinom(n, size = 1, prob = .5)
# simulate age. younger users more likely to adapt.
age <- rbeta(n, 2, 5) %>% scales::rescale(to = c(12, 65))
# simulate who used feature
use_enc  <- .35 + (4/age) # (encouraged group)
use_enc[use_enc>1] <- 1
use_nenc <- .15 + (4/age)# (not encouraged group)
used_ftr <- rbinom(n, size = 1, if_else(popup == 1, use_enc, use_nenc))
# simulate outcome. users who use feature spend more time on app.
time_spent <- 10*used_ftr + .05*(100-age) + rnorm(n, 5, 5)
df <- tibble(popup   = popup,
used_ftr   = used_ftr,
unobserved = age,
time_spent = time_spent)
cor(df) %>% round(2)
saveRDS(df, "content/course_weeks/week_07/rand_enc_assignment.rds")
re2 <- readRDS("~/my_drive/02_TUHH/03_github/causal_ds_ss24/content/course_weeks/week_07/rand_enc_assignment.rds")
# runs conditional outcome regression model
model <- lm(time_spent ~ used_ftr + unobserved, data = re2)
# runs sensemakr for sensitivity analysis
sensitivity <- sensemakr(model = model, treatment = "used_ftr",
benchmark_covariates = c("unobserved"), kd=.5)
# runs sensemakr for sensitivity analysis
sensitivity <- sensemakr(model = model, treatment = "used_ftr",
benchmark_covariates = c("unobserved"), kd=1:3)
sensitivity
plot(sensitivity)
summary(sensitivity)
n <- 1e+4
# simulate who was encouraged to use feature
popup <- rbinom(n, size = 1, prob = .5)
# simulate age. younger users more likely to adapt.
age <- rbeta(n, 2, 5) %>% scales::rescale(to = c(12, 65))
# simulate who used feature
use_enc  <- .35 + (4/age) # (encouraged group)
use_enc[use_enc>1] <- 1
use_nenc <- .15 + (4/age)# (not encouraged group)
used_ftr <- rbinom(n, size = 1, if_else(popup == 1, use_enc, use_nenc))
# simulate outcome. users who use feature spend more time on app.
time_spent <- 4*used_ftr + .05*(100-age) + rnorm(n, 55, 12)
df <- tibble(popup   = popup,
used_ftr   = used_ftr,
unobserved = age,
time_spent = time_spent)
cor(df) %>% round(2)
saveRDS(df, "content/course_weeks/week_07/rand_enc_assignment.rds")
re2 <- readRDS("~/my_drive/02_TUHH/03_github/causal_ds_ss24/content/course_weeks/week_07/rand_enc_assignment.rds")
# runs conditional outcome regression model
model <- lm(time_spent ~ used_ftr + unobserved, data = re2)
# runs sensemakr for sensitivity analysis
sensitivity <- sensemakr(model = model, treatment = "used_ftr",
benchmark_covariates = c("unobserved"), kd=1:3)
sensitivity
plot(sensitivity)
benchmark_covariates = c("unobserved"), kd=c(5, 10)
# runs sensemakr for sensitivity analysis
sensitivity <- sensemakr(model = model, treatment = "used_ftr",
benchmark_covariates = c("unobserved"), kd=c(5, 10))
sensitivity
plot(sensitivity)
summary(sensitivity)
# simulate outcome. users who use feature spend more time on app.
time_spent <- 4*used_ftr + .25*(100-age) + rnorm(n, 55, 12)
df <- tibble(popup   = popup,
used_ftr   = used_ftr,
unobserved = age,
time_spent = time_spent)
cor(df) %>% round(2)
saveRDS(df, "content/course_weeks/week_07/rand_enc_assignment.rds")
re2 <- readRDS("~/my_drive/02_TUHH/03_github/causal_ds_ss24/content/course_weeks/week_07/rand_enc_assignment.rds")
# runs conditional outcome regression model
model <- lm(time_spent ~ used_ftr + unobserved, data = re2)
# runs sensemakr for sensitivity analysis
sensitivity <- sensemakr(model = model, treatment = "used_ftr",
benchmark_covariates = c("unobserved"), kd=c(5, 10))
sensitivity
plot(sensitivity)
# runs sensemakr for sensitivity analysis
sensitivity <- sensemakr(model = model, treatment = "used_ftr",
benchmark_covariates = c("unobserved"), kd=c(1, 2, 3))
sensitivity
plot(sensitivity)
summary(sensitivity)
sensitivity
re2$time_spent
re2$time_spent |> min()
sensitivity
# simulate outcome. users who use feature spend more time on app.
time_spent <- 3*used_ftr + .3*(100-age) + rnorm(n, 55, 17)
df <- tibble(popup   = popup,
used_ftr   = used_ftr,
unobserved = age,
time_spent = time_spent)
cor(df) %>% round(2)
saveRDS(df, "content/course_weeks/week_07/rand_enc_assignment.rds")
re2 <- readRDS("~/my_drive/02_TUHH/03_github/causal_ds_ss24/content/course_weeks/week_07/rand_enc_assignment.rds")
# runs conditional outcome regression model
model <- lm(time_spent ~ used_ftr + unobserved, data = re2)
# runs sensemakr for sensitivity analysis
sensitivity <- sensemakr(model = model, treatment = "used_ftr",
benchmark_covariates = c("unobserved"), kd=c(1, 2, 3))
sensitivity
plot(sensitivity)
summary(sensitivity)
# simulate outcome. users who use feature spend more time on app.
time_spent <- 10*used_ftr + .3*(100-age) + rnorm(n, 55, 17)
df <- tibble(popup   = popup,
used_ftr   = used_ftr,
unobserved = age,
time_spent = time_spent)
cor(df) %>% round(2)
saveRDS(df, "content/course_weeks/week_07/rand_enc_assignment.rds")
re2 <- readRDS("~/my_drive/02_TUHH/03_github/causal_ds_ss24/content/course_weeks/week_07/rand_enc_assignment.rds")
# runs conditional outcome regression model
model <- lm(time_spent ~ used_ftr + unobserved, data = re2)
# runs sensemakr for sensitivity analysis
sensitivity <- sensemakr(model = model, treatment = "used_ftr",
benchmark_covariates = c("unobserved"), kd=c(1, 2, 3))
sensitivity
plot(sensitivity)
# simulate who used feature
use_enc  <- .35 + (6/age) # (encouraged group)
use_enc[use_enc>1] <- 1
use_nenc <- .15 + (6/age)# (not encouraged group)
used_ftr <- rbinom(n, size = 1, if_else(popup == 1, use_enc, use_nenc))
# simulate outcome. users who use feature spend more time on app.
time_spent <- 10*used_ftr + .3*(100-age) + rnorm(n, 55, 17)
df <- tibble(popup   = popup,
used_ftr   = used_ftr,
unobserved = age,
time_spent = time_spent)
cor(df) %>% round(2)
saveRDS(df, "content/course_weeks/week_07/rand_enc_assignment.rds")
re2 <- readRDS("~/my_drive/02_TUHH/03_github/causal_ds_ss24/content/course_weeks/week_07/rand_enc_assignment.rds")
# runs conditional outcome regression model
model <- lm(time_spent ~ used_ftr + unobserved, data = re2)
# runs sensemakr for sensitivity analysis
sensitivity <- sensemakr(model = model, treatment = "used_ftr",
benchmark_covariates = c("unobserved"), kd=c(1, 2, 3))
sensitivity
plot(sensitivity)
# simulate who used feature
use_enc  <- .35 + (8/age) # (encouraged group)
use_enc[use_enc>1] <- 1
use_nenc <- .15 + (8/age)# (not encouraged group)
used_ftr <- rbinom(n, size = 1, if_else(popup == 1, use_enc, use_nenc))
# simulate outcome. users who use feature spend more time on app.
time_spent <- 10*used_ftr + .3*(100-age) + rnorm(n, 55, 17)
df <- tibble(popup   = popup,
used_ftr   = used_ftr,
unobserved = age,
time_spent = time_spent)
cor(df) %>% round(2)
saveRDS(df, "content/course_weeks/week_07/rand_enc_assignment.rds")
re2 <- readRDS("~/my_drive/02_TUHH/03_github/causal_ds_ss24/content/course_weeks/week_07/rand_enc_assignment.rds")
# runs conditional outcome regression model
model <- lm(time_spent ~ used_ftr + unobserved, data = re2)
# runs sensemakr for sensitivity analysis
sensitivity <- sensemakr(model = model, treatment = "used_ftr",
benchmark_covariates = c("unobserved"), kd=c(1, 2, 3))
sensitivity
plot(sensitivity)
# simulate who used feature
use_enc  <- .35 + (8/age) # (encouraged group)
use_enc[use_enc>1] <- 1
use_nenc <- .1 + (8/age)# (not encouraged group)
used_ftr <- rbinom(n, size = 1, if_else(popup == 1, use_enc, use_nenc))
# simulate outcome. users who use feature spend more time on app.
time_spent <- 10*used_ftr + .3*(100-age) + rnorm(n, 55, 17)
df <- tibble(popup   = popup,
used_ftr   = used_ftr,
unobserved = age,
time_spent = time_spent)
cor(df) %>% round(2)
saveRDS(df, "content/course_weeks/week_07/rand_enc_assignment.rds")
re2 <- readRDS("~/my_drive/02_TUHH/03_github/causal_ds_ss24/content/course_weeks/week_07/rand_enc_assignment.rds")
# runs conditional outcome regression model
model <- lm(time_spent ~ used_ftr + unobserved, data = re2)
# runs sensemakr for sensitivity analysis
sensitivity <- sensemakr(model = model, treatment = "used_ftr",
benchmark_covariates = c("unobserved"), kd=c(1, 2, 3))
sensitivity
plot(sensitivity)
# simulate outcome. users who use feature spend more time on app.
time_spent <- 10*used_ftr + .3*(100-age) + rnorm(n, 55, 20)
df <- tibble(popup   = popup,
used_ftr   = used_ftr,
unobserved = age,
time_spent = time_spent)
cor(df) %>% round(2)
saveRDS(df, "content/course_weeks/week_07/rand_enc_assignment.rds")
re2 <- readRDS("~/my_drive/02_TUHH/03_github/causal_ds_ss24/content/course_weeks/week_07/rand_enc_assignment.rds")
# runs conditional outcome regression model
model <- lm(time_spent ~ used_ftr + unobserved, data = re2)
# runs sensemakr for sensitivity analysis
sensitivity <- sensemakr(model = model, treatment = "used_ftr",
benchmark_covariates = c("unobserved"), kd=c(1, 2, 3))
sensitivity
plot(sensitivity)
# simulate outcome. users who use feature spend more time on app.
time_spent <- 10*used_ftr + .3*(100-age) + rnorm(n, 55, 20)
df <- tibble(popup   = popup,
used_ftr   = used_ftr,
unobserved = age,
time_spent = time_spent)
cor(df) %>% round(2)
saveRDS(df, "content/course_weeks/week_07/rand_enc_assignment.rds")
# simulate who used feature
use_enc  <- .35 + (8/age) # (encouraged group)
use_enc[use_enc>1] <- 1
use_nenc <- .1 + (8/age)# (not encouraged group)
used_ftr <- rbinom(n, size = 1, if_else(popup == 1, use_enc, use_nenc))
# simulate outcome. users who use feature spend more time on app.
time_spent <- 10*used_ftr + .6*(100-age) + rnorm(n, 55, 20)
df <- tibble(popup   = popup,
used_ftr   = used_ftr,
unobserved = age,
time_spent = time_spent)
cor(df) %>% round(2)
saveRDS(df, "content/course_weeks/week_07/rand_enc_assignment.rds")
re2 <- readRDS("~/my_drive/02_TUHH/03_github/causal_ds_ss24/content/course_weeks/week_07/rand_enc_assignment.rds")
# runs conditional outcome regression model
model <- lm(time_spent ~ used_ftr + unobserved, data = re2)
# runs sensemakr for sensitivity analysis
sensitivity <- sensemakr(model = model, treatment = "used_ftr",
benchmark_covariates = c("unobserved"), kd=c(1, 2, 3))
sensitivity
plot(sensitivity)
# simulate outcome. users who use feature spend more time on app.
time_spent <- 10*used_ftr + .7*(100-age) + rnorm(n, 55, 20)
df <- tibble(popup   = popup,
used_ftr   = used_ftr,
unobserved = age,
time_spent = time_spent)
cor(df) %>% round(2)
saveRDS(df, "content/course_weeks/week_07/rand_enc_assignment.rds")
re2 <- readRDS("~/my_drive/02_TUHH/03_github/causal_ds_ss24/content/course_weeks/week_07/rand_enc_assignment.rds")
# runs conditional outcome regression model
model <- lm(time_spent ~ used_ftr + unobserved, data = re2)
# runs sensemakr for sensitivity analysis
sensitivity <- sensemakr(model = model, treatment = "used_ftr",
benchmark_covariates = c("unobserved"), kd=c(1, 2, 3))
sensitivity
plot(sensitivity)
re2 <- readRDS("~/my_drive/02_TUHH/03_github/causal_ds_ss24/content/course_weeks/week_07/rand_enc_assignment.rds")
# runs conditional outcome regression model
model <- lm(time_spent ~ used_ftr + unobserved, data = re2)
# runs sensemakr for sensitivity analysis
sensitivity <- sensemakr(model = model, treatment = "used_ftr",
benchmark_covariates = c("unobserved"), kd=c(1, 2, 3))
sensitivity
plot(sensitivity)
# simulate outcome. users who use feature spend more time on app.
time_spent <- 10*used_ftr + .7*(100-age) + rnorm(n, 55, 20)
df <- tibble(popup   = popup,
used_ftr   = used_ftr,
unobserved = age,
time_spent = time_spent)
cor(df) %>% round(2)
saveRDS(df, "content/course_weeks/week_07/rand_enc_assignment.rds")
re2 <- readRDS("~/my_drive/02_TUHH/03_github/causal_ds_ss24/content/course_weeks/week_07/rand_enc_assignment.rds")
# runs conditional outcome regression model
model <- lm(time_spent ~ used_ftr + unobserved, data = re2)
# runs sensemakr for sensitivity analysis
sensitivity <- sensemakr(model = model, treatment = "used_ftr",
benchmark_covariates = c("unobserved"), kd=c(1, 2, 3))
sensitivity
plot(sensitivity)
# simulate who used feature
use_enc  <- .35 + (8/age) # (encouraged group)
use_enc[use_enc>1] <- 1
use_nenc <- .1 + (8/age)# (not encouraged group)
used_ftr <- rbinom(n, size = 1, if_else(popup == 1, use_enc, use_nenc))
# simulate outcome. users who use feature spend more time on app.
time_spent <- 10*used_ftr + .8*(100-age) + rnorm(n, 55, 20)
df <- tibble(popup   = popup,
used_ftr   = used_ftr,
unobserved = age,
time_spent = time_spent)
cor(df) %>% round(2)
saveRDS(df, "content/course_weeks/week_07/rand_enc_assignment.rds")
re2 <- readRDS("~/my_drive/02_TUHH/03_github/causal_ds_ss24/content/course_weeks/week_07/rand_enc_assignment.rds")
# runs conditional outcome regression model
model <- lm(time_spent ~ used_ftr + unobserved, data = re2)
# runs sensemakr for sensitivity analysis
sensitivity <- sensemakr(model = model, treatment = "used_ftr",
benchmark_covariates = c("unobserved"), kd=c(1, 2, 3))
sensitivity
plot(sensitivity)
re2$time_spent
re2$time_spent |> summary()
# simulate outcome. users who use feature spend more time on app.
time_spent <- 10*used_ftr + .8*(100-age) + rnorm(n, 25, 20)
df <- tibble(popup   = popup,
used_ftr   = used_ftr,
unobserved = age,
time_spent = time_spent)
cor(df) %>% round(2)
saveRDS(df, "content/course_weeks/week_07/rand_enc_assignment.rds")
re2 <- readRDS("~/my_drive/02_TUHH/03_github/causal_ds_ss24/content/course_weeks/week_07/rand_enc_assignment.rds")
# runs conditional outcome regression model
model <- lm(time_spent ~ used_ftr + unobserved, data = re2)
# runs sensemakr for sensitivity analysis
sensitivity <- sensemakr(model = model, treatment = "used_ftr",
benchmark_covariates = c("unobserved"), kd=c(1, 2, 3))
sensitivity
plot(sensitivity)
df <- tibble(popup   = popup,
used_ftr   = used_ftr,
age = age,
time_spent = time_spent)
cor(df) %>% round(2)
saveRDS(df, "content/course_weeks/week_07/rand_enc_assignment.rds")
df <- tibble(#popup   = popup,
used_ftr   = used_ftr,
age = age,
time_spent = time_spent)
saveRDS(df, "content/course_weeks/week_07/.rds")
saveRDS(df, "content/course_weeks/week_07/task_3.rds")
